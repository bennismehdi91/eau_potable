select
    city.unique_key,
    city.annee,
    city.nom_commune_adherente,
    city.id_sispea_commune_adherente,
    city.code_insee_commune_adherente,
    city.id_sispea_collectivite_via_laquelle_la_commune_adhere,
    city.id_sispea_entite_gestion_a_laquelle_la_commune_adhere,
    city.new_dpt_commune,
    city.zip_code,
    city.label,
    city.latitude,
    city.longitude,
    city.department_name,
    city.department_number,
    city.region_geojson_name,
    entite.region_name,
    entite.tx_microbio_cast,
    entite.tx_physio_cast,
    entite.cluster_3_pop_service,
    entite.ipl_note,
    entite.cat_densite,
    entite.departement,
    entite.id_sispea_collectivite,
    entite.nom_collectivite,
    entite.id_sispea_entite_de_gestion,
    entite.nom_entite_de_gestion,
    entite.communes_adherentes_entite_de_gestion,
    entite.pop_entite_de_gestion_sans_double_compte,
    entite.mode_de_gestion,
    entite.statut_operateur,
    entite.nom_operateur,
    entite.statut,
    entite.nb_habitants_desservis,
    entite.prix_ttc_m3,
    entite.tx_conformite_microbiologie,
    entite.tx_conformite_physiochimiques,
    entite.indice_lieaire_perte_reseau,
    entite.tx_moyen_renouvellement_reseau,
    entite.indice_protection_ressource,
    entite.nb_abonnes,
    entite.epargne_brute_annuelle,
    entite.lineaire_reseau_hors_branchement,
    entite.densite_lineaire_abonnes,
    entite.ratio_habitant_par_abonne,
    entite.consommation_moyenne_par_abonne,
    entite.year
from {{ ref("int_citiesfinal_1") }} as city
left join
    {{ ref("int_final_entite_with_cluster_3") }} as entite
    on city.unique_key = entite.unique_key